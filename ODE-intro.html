

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Introduction to Differential Equations &#8212; Jupyter Labs for University of Lethbridge Calculus</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'ODE-intro';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Lab 5: Differential Equations" href="Calc2-Lab4-ODEs.html" />
    <link rel="prev" title="Lab 4: Arc length and surface area" href="Calc2-Lab3-Surface-Area.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/fiatlux.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/fiatlux.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Jupyter Labs for Lethbridge Calculus
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="python.html">Intro to Python for calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="IntrotoPython.html">Intro to Python for Calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="sympy.html">Intro to SymPy for Calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="IntrotoSymPy.html">Intro to SymPy for Calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="numpy.html">Intro to NumPy for calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="IntrotoNumPy.html">Intro to NumPy for Calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc1-Lab1-Limits.html">Limits and Python!</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc1-Lab2-Derivatives.html">Derivatives, Derivatives, and Derivatives!</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc1-Lab3-Approximations.html">Plotting and Approximating!</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc1-Lab4-Integration.html">Riemann Sums and Taylor Polynomials</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc2-Lab0-Review-of-Python.html">Lab 0: Numpy and Sympy for Calculus</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc2-Lab1-Partial-Fractions.html">Lab 2: Partial Fractions</a></li>
<li class="toctree-l1"><a class="reference internal" href="numerical-integration-example.html">Math 2565 coding example: Using NumPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc2-Lab2-Arc-Length.html">Lab 3: Arc length and numerical integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc2-Lab3-Surface-Area.html">Lab 4: Arc length and surface area</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Introduction to Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc2-Lab4-ODEs.html">Lab 5: Differential Equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc2-Lab5-ODE-systems.html">Tutorial 6: Systems of differential equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc2-Lab6-Parametric-Curves.html">Lab 7: Parametric curves</a></li>
<li class="toctree-l1"><a class="reference internal" href="Calc2-Lab7-Polar-Curves.html">Lab 8: Polar curves</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://uleth.syzygy.ca/jupyter/hub/user-redirect/git-pull?repo=https%3A//github.com/sean-fitzpatrick/CalcLabs&urlpath=tree/CalcLabs/ODE-intro.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/sean-fitzpatrick/CalcLabs" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/sean-fitzpatrick/CalcLabs/issues/new?title=Issue%20on%20page%20%2FODE-intro.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/ODE-intro.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Introduction to Differential Equations</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-and-numerical-solutions">Graphical and Numerical Solutions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#math-2565">Math 2565</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spring-2023">Spring 2023</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#university-of-lethbridge">University of Lethbridge</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sean-fitzpatrick">Sean Fitzpatrick</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#differential-equations">Differential Equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology">Terminology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-value-problems">Initial Value Problems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verifying-solutions">Verifying Solutions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-methods">Graphical Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-diagrams-for-autonomous-first-order-odes">Phase diagrams for autonomous first order ODEs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#direction-fields">Direction fields</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-methods">Numerical Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#euler-s-method">Euler’s Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-analysis">Error analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-for-euler-s-method">Code for Euler’s Method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-solution">Checking the solution</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-solving-with-sympy">Symbolic solving with SymPy</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="introduction-to-differential-equations">
<h1>Introduction to Differential Equations<a class="headerlink" href="#introduction-to-differential-equations" title="Permalink to this heading">#</a></h1>
<section id="graphical-and-numerical-solutions">
<h2>Graphical and Numerical Solutions<a class="headerlink" href="#graphical-and-numerical-solutions" title="Permalink to this heading">#</a></h2>
<section id="math-2565">
<h3>Math 2565<a class="headerlink" href="#math-2565" title="Permalink to this heading">#</a></h3>
</section>
<section id="spring-2023">
<h3>Spring 2023<a class="headerlink" href="#spring-2023" title="Permalink to this heading">#</a></h3>
</section>
<section id="university-of-lethbridge">
<h3>University of Lethbridge<a class="headerlink" href="#university-of-lethbridge" title="Permalink to this heading">#</a></h3>
<section id="sean-fitzpatrick">
<h4>Sean Fitzpatrick<a class="headerlink" href="#sean-fitzpatrick" title="Permalink to this heading">#</a></h4>
</section>
</section>
</section>
<section id="differential-equations">
<h2>Differential Equations<a class="headerlink" href="#differential-equations" title="Permalink to this heading">#</a></h2>
<p>A <strong>differential equation</strong> is any equation relating a (typically unknown) function and one or more of its derivatives. The goal is to find the function(s) that satisfy the equation.</p>
<p>Typically the function in a differential equation will be assigned to some <em>dependent variable</em> and depend on one or more <em>independent variables</em>.</p>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[y\,' = 4\cos(x)+2\]</div>
<p>Here, <span class="math notranslate nohighlight">\(y\)</span> is the dependent variable, <span class="math notranslate nohighlight">\(x\)</span> is the independent variable, and a <em>solution</em> is given by <span class="math notranslate nohighlight">\(y = 4\sin(x)+2x\)</span>.</p>
</section>
<section id="terminology">
<h3>Terminology<a class="headerlink" href="#terminology" title="Permalink to this heading">#</a></h3>
<p>The <strong>order</strong> of a differential equation is the highest derivative that appears.</p>
<p>An <strong>ordinary differential equation</strong> (ODE) involves only one independent variable.</p>
<p>A <strong>partial differential equation</strong> (PDE) involves two or more independent variables (and partial derivatives).</p>
<ul class="simple">
<li><p>First order ODE example:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{dy}{dx} + x^2\, y = e^x\]</div>
<ul class="simple">
<li><p>Second order ODE example:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[y\,'' - ky = 4\sin(3x)\]</div>
<ul class="simple">
<li><p>PDE example:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{1}{i\hbar}\frac{\partial^2 \psi}{\partial x^2} + V(x,t) = \frac{\partial \psi}{\partial t}\]</div>
</section>
<section id="initial-value-problems">
<h3>Initial Value Problems<a class="headerlink" href="#initial-value-problems" title="Permalink to this heading">#</a></h3>
<p>A solution to a differential equation typically involves one or more undetermined parameters.</p>
<p>For example, <span class="math notranslate nohighlight">\(y=4\sin(x)+2x\)</span> is a solution to <span class="math notranslate nohighlight">\(y' = 4\cos(x)+2\)</span>, but so is <span class="math notranslate nohighlight">\(y=4\sin(x)+2x+C\)</span> for any constant <span class="math notranslate nohighlight">\(C\)</span>.</p>
<p>The number of parameters is equal to the order of the differential equation.</p>
<p>A solution in terms of these parameters is called the <strong>general solution</strong>. Putting in values for each parameter produces a <strong>particular solution</strong>.</p>
<p>Particular solutions are often determined by <em>initial values</em>.</p>
<p>E.g. we can ask for <span class="math notranslate nohighlight">\(y'=4\cos(x)+2x\)</span>, where <span class="math notranslate nohighlight">\(y(0)=2\)</span>.</p>
</section>
<section id="verifying-solutions">
<h3>Verifying Solutions<a class="headerlink" href="#verifying-solutions" title="Permalink to this heading">#</a></h3>
<p>To verify that <span class="math notranslate nohighlight">\(y=f(x)\)</span> solves a differential equation, simply plug it in and confirm that it works.</p>
<p>Examples:</p>
<ol class="arabic simple">
<li><p>Verify that <span class="math notranslate nohighlight">\(x = \cos(t)+\sin(t)\)</span> is a solution to <span class="math notranslate nohighlight">\(\frac{dx}{dt}+x=2\cos(t)\)</span></p></li>
<li><p>Show that <span class="math notranslate nohighlight">\(N(t)=Ce^{-5t}\)</span> is a solution to <span class="math notranslate nohighlight">\(\frac{dN}{dt} = -5N\)</span>, and find the value of <span class="math notranslate nohighlight">\(C\)</span> such that <span class="math notranslate nohighlight">\(N(0)=2565\)</span>.</p></li>
<li><p>Determine all values of <span class="math notranslate nohighlight">\(k\)</span> such that <span class="math notranslate nohighlight">\(f(x)=Ce^{kx}\)</span> is a solution to <span class="math notranslate nohighlight">\(y\,''-4y\,'+4y=0\)</span>. What about <span class="math notranslate nohighlight">\(g(x)=Cxe^{kx}\)</span>?</p></li>
</ol>
</section>
</section>
<section id="graphical-methods">
<h2>Graphical Methods<a class="headerlink" href="#graphical-methods" title="Permalink to this heading">#</a></h2>
<p>Many differential equations can be studied <em>qualitatively</em> in cases where they can’t be studied analytically.</p>
<p>(Finding exact solutions to real-world differential equation models is rare.)</p>
<p><strong>Phase portraits</strong> are an important tool for the study of dynamical systems. (These are especially useful for nonlinear ODEs and systems of ODEs.)</p>
<p>Using phase portraits we can understand systems in terms of sinks, sources, stable and unstable equlibria, etc.</p>
<p><strong>Direction fields</strong> capture some of the same ideas, and are easier to understand at the introductory level.</p>
<section id="phase-diagrams-for-autonomous-first-order-odes">
<h3>Phase diagrams for autonomous first order ODEs<a class="headerlink" href="#phase-diagrams-for-autonomous-first-order-odes" title="Permalink to this heading">#</a></h3>
<p>Most phase diagrams are higher-dimensional and correspond to systems of coupled first-order ODEs.</p>
<p>They’re also really cool, but beyond this course.</p>
<p>We can do something similar for equations of the form</p>
<div class="math notranslate nohighlight">
\[\dot{x} = \frac{dx}{dt} = f(x).\]</div>
<p>(Note <span class="math notranslate nohighlight">\(f(x)\)</span>, not <span class="math notranslate nohighlight">\(f(x,t)\)</span>.)</p>
<p>Here, we can determine whether <span class="math notranslate nohighlight">\(x(t)\)</span> is increasing or decreasing simply by whether <span class="math notranslate nohighlight">\(f(x)\)</span> is positive or negative. (Sign diagrams!)</p>
</section>
<section id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h3>
<p><strong>Logistic model</strong>:</p>
<div class="math notranslate nohighlight">
\[\frac{dP}{dt} = kP\left(1-\frac{P}{M}\right)\]</div>
<p>Note: critical points of <span class="math notranslate nohighlight">\(f(x)\)</span> in <span class="math notranslate nohighlight">\(\dot{x} = f(x)\)</span> correspond to equilibria. (What can you say about local max vs. local min?)</p>
<p>Sometimes small changes in <span class="math notranslate nohighlight">\(f(x)\)</span> lead to big changes in behaviour. This is called <em>bifurcation</em>.</p>
<p><strong>Pitchfork bifurcation</strong>:</p>
<div class="math notranslate nohighlight">
\[\dot{x} = x(k-x^2)\]</div>
<p>This has one critical point for <span class="math notranslate nohighlight">\(k\leq 0\)</span>, and three, for <span class="math notranslate nohighlight">\(k&gt;0\)</span>.</p>
</section>
<section id="direction-fields">
<h3>Direction fields<a class="headerlink" href="#direction-fields" title="Permalink to this heading">#</a></h3>
<p>The idea is simple: most first-order ODEs can be put in the form <span class="math notranslate nohighlight">\(y' = f(x,y)\)</span> for some function <span class="math notranslate nohighlight">\(f\)</span> of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>.</p>
<p>A solution <span class="math notranslate nohighlight">\(y=g(x)\)</span> would satisfy <span class="math notranslate nohighlight">\(g'(x) = f(x,g(x))\)</span>. So <span class="math notranslate nohighlight">\(f(x,y)\)</span> gives the <strong>slope</strong> of the tangent line to <span class="math notranslate nohighlight">\(y=g(x)\)</span> at <span class="math notranslate nohighlight">\((x,y)\)</span>.</p>
<p>To construct a direction field, just evaluate <span class="math notranslate nohighlight">\(f(x,y)\)</span> at a sample of points, and plot a short line segment through <span class="math notranslate nohighlight">\((x,y)\)</span> with slope <span class="math notranslate nohighlight">\(m=f(x,y)\)</span>.</p>
</section>
<section id="id1">
<h3>Example<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<p>Plot a direction field for the differential equation <span class="math notranslate nohighlight">\(y\,' = x-y\)</span>.</p>
</section>
<section id="id2">
<h3>Example<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<p>Plot a direction field for the differential equation <span class="math notranslate nohighlight">\(y\,' = x\sin(y)\)</span>.</p>
<p>Maybe we don’t want to plot this by hand. Let’s <a class="reference external" href="http://firsttimeprogrammer.blogspot.com/2014/09/generate-slope-fields-in-r-and-python.html">borrow some simple code</a> to do it. The code is set up for the equation <span class="math notranslate nohighlight">\(y'=x-y\)</span>. You’ll need to change the definition of <code class="docutils literal notranslate"><span class="pre">f(x,y)</span></code> to do the <span class="math notranslate nohighlight">\(y'=x\sin(y)\)</span> example.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">odeint</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>Note one oddity here: we are defining <code class="docutils literal notranslate"><span class="pre">f(y,x)</span></code> instead of <code class="docutils literal notranslate"><span class="pre">f(x,y)</span></code>. This is because one of the ODE solvers from SciPy that we’ll be using soon expects this order. (This resulted in an hour of confusion for me…)</p>
<p>We can manage with this as long as we’re aware of it when we define our slope field: we need to use <code class="docutils literal notranslate"><span class="pre">f(k,j)</span></code> for the slope instead of <code class="docutils literal notranslate"><span class="pre">f(j,k)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">):</span> <span class="c1"># define our equation</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span> <span class="c1"># change this to x*np.sin(y) for second example</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">dfield</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span>
            <span class="n">slope</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
            <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="n">x1</span><span class="p">):</span>
                <span class="n">z</span> <span class="o">=</span> <span class="n">slope</span><span class="o">*</span><span class="p">(</span><span class="n">domain</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="n">y1</span>
                <span class="k">return</span> <span class="n">z</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span><span class="n">fun</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">),</span><span class="n">solid_capstyle</span><span class="o">=</span><span class="s1">&#39;projecting&#39;</span><span class="p">,</span><span class="n">solid_joinstyle</span><span class="o">=</span><span class="s1">&#39;bevel&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Slope field for y&#39;=f(x,y)&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">dfield</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we can try using the computer to solve the ODE, and see how the solution fits.</p>
<p>We’re using the <em>SciPy</em>, which is quite powerful. I’ve borred an example <a class="reference external" href="https://sam-dolan.staff.shef.ac.uk/mas212/notebooks/ODE_Example.html">from here</a> that solves a problem similar to ours.</p>
<p>If you anticipate using the computer to solve ODEs in other courses, also consider <em>SymPy</em> for equations that can be solved exactly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#If you need to change the function, uncomment the next two lines and update the definition</span>
<span class="c1">#def f(y, x):</span>
<span class="c1">#    return x - y</span>

<span class="c1">#x = np.linspace(-5,5,100)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># the initial condition</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<p>The graph doesn’t look great. This is mostly because we only used 20 sample points when we originally set things up for the direction field. Let’s try uncommenting the <code class="docutils literal notranslate"><span class="pre">x=np.linspace(-5,5,100)</span></code> line above and then running the plot command again.</p>
<p>Now we try to combine things, and plot the solution curve on the same grid as the direction field. The <code class="docutils literal notranslate"><span class="pre">dfplot</span></code> code is based on the <code class="docutils literal notranslate"><span class="pre">dfield</span></code> code above, with additional lines added to include the solution curve.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">d</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">slopesamples</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">solvesamples</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">slopesamples</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">slopesamples</span><span class="p">)</span>
<span class="n">xsolve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">solvesamples</span><span class="p">)</span>
<span class="c1">#y0 = -1.0</span>

<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span>

<span class="k">def</span> <span class="nf">dfplot</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">y0</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">y</span><span class="p">:</span>
                <span class="n">slope</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
                <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mf">0.05</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">):</span>
                    <span class="n">z</span> <span class="o">=</span> <span class="n">slope</span><span class="o">*</span><span class="p">(</span><span class="n">domain</span><span class="o">-</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="n">y1</span>
                    <span class="k">return</span> <span class="n">z</span>
                <span class="n">ysolve</span> <span class="o">=</span> <span class="n">odeint</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">xsolve</span><span class="p">)</span>
                <span class="n">ysolve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ysolve</span><span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span><span class="n">fun</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">solid_capstyle</span><span class="o">=</span><span class="s1">&#39;projecting&#39;</span><span class="p">,</span><span class="n">solid_joinstyle</span><span class="o">=</span><span class="s1">&#39;bevel&#39;</span><span class="p">)</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xsolve</span><span class="p">,</span><span class="n">ysolve</span><span class="p">)</span>


        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Slope field for y&#39;=f(x,y)&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">d</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfplot</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="numerical-methods">
<h2>Numerical Methods<a class="headerlink" href="#numerical-methods" title="Permalink to this heading">#</a></h2>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">odeint</span></code> function from SciPy does not give us a function in the sense you’re used to.</p>
<p>Instead, for a set of possible <span class="math notranslate nohighlight">\(x\)</span> values, it determines corresponding <span class="math notranslate nohighlight">\(y\)</span> values numerically.</p>
<p>There are some very sophisticated methods for doing this. We’ll look at one of the most basic.</p>
<section id="euler-s-method">
<h3>Euler’s Method<a class="headerlink" href="#euler-s-method" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Essentially a numerical counterpart to slope fields.</p></li>
<li><p>Recall the linear approximation</p></li>
</ul>
<div class="math notranslate nohighlight">
\[g(x_0+\Delta x) \approx g(x_0) + g'(x_0)\Delta x.\]</div>
<ul class="simple">
<li><p>Given <span class="math notranslate nohighlight">\(y'=f(x,y)\)</span>, look for solution <span class="math notranslate nohighlight">\(y=g(x)\)</span> with initial condition <span class="math notranslate nohighlight">\(g(x_0)=y_0\)</span>.</p></li>
<li><p>Notice <span class="math notranslate nohighlight">\(g'(x_0) = f(x_0,y_0)\)</span>.</p></li>
<li><p>Proceed in “steps”, with fixed <strong>step size</strong> <span class="math notranslate nohighlight">\(\Delta x\)</span> as follows:</p></li>
</ul>
<ol class="arabic simple">
<li><p><span class="math notranslate nohighlight">\((x_0,y_0)\)</span> is given.</p></li>
<li><p><span class="math notranslate nohighlight">\(x_1 = x_0+\Delta x\)</span> and <span class="math notranslate nohighlight">\(y_1 = y_0+f(x_0,y_0)\Delta x\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_2 = x_0+2\Delta x\)</span> and <span class="math notranslate nohighlight">\(y_2 = y_1+f(x_1,y_1)\Delta x\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(x_3 = x_0+3\Delta x\)</span> and <span class="math notranslate nohighlight">\(y_3 = y_2+f(x_2,y_2)\Delta x\)</span></p></li>
</ol>
<p>etc.</p>
</section>
<section id="error-analysis">
<h3>Error analysis<a class="headerlink" href="#error-analysis" title="Permalink to this heading">#</a></h3>
<p>Euler’s method is simple, but imprecise.</p>
<ul class="simple">
<li><p>Using linear approximation introduces truncation error.</p></li>
<li><p>Size of this error depends on step size.</p></li>
<li><p>Error compounds at every step due to recursive nature.</p></li>
</ul>
</section>
<section id="id3">
<h3>Example<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<p>Use Euler’s method to approximate the solution to <span class="math notranslate nohighlight">\(y'=x-y\)</span>, with initial condition <span class="math notranslate nohighlight">\(y(0)=1\)</span>, step size of <span class="math notranslate nohighlight">\(0.1\)</span>, and 10 steps.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><span class="math notranslate nohighlight">\(i\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(x_i\)</span></p></th>
<th class="head"><p>                            <span class="math notranslate nohighlight">\(y_i\)</span>                            </p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>0</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>0.1</p></td>
<td><p><span class="math notranslate nohighlight">\(1+(0-1)(0.1) = 0.9\)</span></p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>0.2</p></td>
<td><p><span class="math notranslate nohighlight">\(0.9 + (0.1-0.9)(0.1) = 0.82\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>0.3</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<p>We might need a code cell as a calculator.</p>
</section>
<section id="code-for-euler-s-method">
<h3>Code for Euler’s Method<a class="headerlink" href="#code-for-euler-s-method" title="Permalink to this heading">#</a></h3>
<p>The following is borrowed from <a class="reference external" href="https://www.math.ubc.ca/~pwalls/math-python/differential-equations/first-order/">Patrick Walls at UBC</a>. We define a function called odeEuler that implements the steps outlined above.</p>
<p>Input is an ODE of the form <span class="math notranslate nohighlight">\(y'=f(y,t)\)</span>. Syntax is <code class="docutils literal notranslate"><span class="pre">odeEuler(f,y0,t)</span></code>, where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">f</span></code> is our function</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y0</span></code> is the initial value for <span class="math notranslate nohighlight">\(y\)</span>, corresponding to the value in <code class="docutils literal notranslate"><span class="pre">t</span></code> at index 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code> is a NumPy array (the values to be used for the steps)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">odeEuler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
    <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">+</span> <span class="n">f</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="n">n</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">y</span>
</pre></div>
</div>
</div>
</div>
<p>The output is a NumPy array containing the <span class="math notranslate nohighlight">\(y\)</span> values correpsonding to the <span class="math notranslate nohighlight">\(t\)</span> values in <code class="docutils literal notranslate"><span class="pre">t</span></code>. Let’s try it out.<br>
The next cell will print the sample <span class="math notranslate nohighlight">\(t\)</span> values, and then the corresponding <span class="math notranslate nohighlight">\(y\)</span> values. <code class="docutils literal notranslate"><span class="pre">np.linspace(0,1,11)</span></code> means we use the interval <span class="math notranslate nohighlight">\([0,1]\)</span>, with 11 sample points.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">y</span><span class="p">,</span><span class="n">t</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">t</span><span class="o">-</span><span class="n">y</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">)</span>
<span class="n">y0</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">t</span><span class="p">,</span><span class="n">odeEuler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="checking-the-solution">
<h4>Checking the solution<a class="headerlink" href="#checking-the-solution" title="Permalink to this heading">#</a></h4>
<p>How well does our algorithm work? We can plot our values against the exact ones.<br>
The equation</p>
<div class="math notranslate nohighlight">
\[\frac{dy}{dt} = t-y\]</div>
<p>is linear – we’ll learn how to solve it soon.
The general solution is</p>
<div class="math notranslate nohighlight">
\[y(t)=t-1+Ce^{-t}.\]</div>
<p>With <span class="math notranslate nohighlight">\(y(t)=1\)</span> we get <span class="math notranslate nohighlight">\(C=2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_exact</span> <span class="o">=</span> <span class="n">t</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span>
<span class="n">y_euler</span> <span class="o">=</span> <span class="n">odeEuler</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">y0</span><span class="p">,</span><span class="n">t</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y_euler</span><span class="p">,</span><span class="s1">&#39;b.-&#39;</span><span class="p">,</span><span class="n">t</span><span class="p">,</span><span class="n">y_exact</span><span class="p">,</span><span class="s1">&#39;r-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">&#39;Euler&#39;</span><span class="p">,</span><span class="s1">&#39;Exact&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="symbolic-solving-with-sympy">
<h3>Symbolic solving with SymPy<a class="headerlink" href="#symbolic-solving-with-sympy" title="Permalink to this heading">#</a></h3>
<p>Another option is the SymPy library for symbolic manipulation. SymPy can handle most derivatives and integrals that Maple (or Wolfram Alpha) can, as well as ODEs. The diffrerence with SymPy is that it does <em>not</em> use numerical methods: it tries to give exact symbolic expressions. (And the <code class="docutils literal notranslate"><span class="pre">init_printing()</span></code> function enables nicely-formatted output.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span> <span class="k">as</span> <span class="nn">sy</span>
<span class="n">sy</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Function</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>

<span class="n">ydot</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">t</span><span class="p">)</span>
<span class="n">eq</span> <span class="o">=</span> <span class="n">sy</span><span class="o">.</span><span class="n">Eq</span><span class="p">(</span><span class="n">ydot</span><span class="p">,</span><span class="n">t</span><span class="o">-</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">eq</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sol</span><span class="o">=</span><span class="n">sy</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="n">sol</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sy</span><span class="o">.</span><span class="n">simplify</span><span class="p">(</span><span class="n">sol</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We can also add initial conditions using the following syntax, which solves the differential equation with initial condition <span class="math notranslate nohighlight">\(y(0)=2\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sy</span><span class="o">.</span><span class="n">dsolve</span><span class="p">(</span><span class="n">eq</span><span class="p">,</span><span class="n">y</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">ics</span><span class="o">=</span><span class="p">{</span><span class="n">y</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span><span class="mi">2</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Calc2-Lab3-Surface-Area.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Lab 4: Arc length and surface area</p>
      </div>
    </a>
    <a class="right-next"
       href="Calc2-Lab4-ODEs.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lab 5: Differential Equations</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-and-numerical-solutions">Graphical and Numerical Solutions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#math-2565">Math 2565</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spring-2023">Spring 2023</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#university-of-lethbridge">University of Lethbridge</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sean-fitzpatrick">Sean Fitzpatrick</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#differential-equations">Differential Equations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#terminology">Terminology</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#initial-value-problems">Initial Value Problems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verifying-solutions">Verifying Solutions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graphical-methods">Graphical Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-diagrams-for-autonomous-first-order-odes">Phase diagrams for autonomous first order ODEs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#direction-fields">Direction fields</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-methods">Numerical Methods</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#euler-s-method">Euler’s Method</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#error-analysis">Error analysis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">Example</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#code-for-euler-s-method">Code for Euler’s Method</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#checking-the-solution">Checking the solution</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symbolic-solving-with-sympy">Symbolic solving with SymPy</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sean Fitzpatrick
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>